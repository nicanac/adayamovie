import{b as g,g as x,l as b,n as C,r as k}from"./chunk-ZPX6YQTG.js";import{$a as d,La as l,Qa as m,T as o,V as c,Va as u,db as i,eb as a,fb as p,kb as h,mb as s,nb as f,qb as v}from"./chunk-HHCBQX7F.js";function A(t,n){if(t&1&&(i(0,"div",2)(1,"div",4)(2,"div",5)(3,"h3",6),s(4),a()()()()),t&2){let e=h();l(4),f(e.error())}}function S(t,n){t&1&&(i(0,"div",3),p(1,"div",7),i(2,"h2",8),s(3," Completing authentication... "),a()())}var w=class t{route=o(b);router=o(C);authService=o(k);window=o(g).defaultView;error=m(null);ngOnInit(){let n=this.window.location.href,e=this.route.snapshot.queryParamMap.get("request_token"),r=this.route.snapshot.queryParamMap.get("approved");if(console.log("Auth callback URL:",n),console.log("Request token:",e),console.log("Approved:",r),!e||r!=="true"){this.error.set("Authentication was cancelled or invalid"),setTimeout(()=>this.router.navigate(["/login"]),3e3);return}this.authService.createSession(e).subscribe({next:()=>{this.router.navigate(["/movies"])},error:y=>{console.error("Session creation error:",y),this.error.set("Failed to create session. Please try again."),setTimeout(()=>this.router.navigate(["/login"]),3e3)}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-auth-callback"]],standalone:!0,features:[v],decls:4,vars:1,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gray-50"],[1,"max-w-md","w-full","space-y-8","p-4"],[1,"rounded-md","bg-red-50","p-4"],[1,"text-center"],[1,"flex"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-500","mx-auto"],[1,"mt-6","text-center","text-3xl","font-bold","tracking-tight","text-gray-900"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1),u(2,A,5,1,"div",2)(3,S,4,0,"div",3),a()()),e&2&&(l(2),d(r.error()?2:3))},dependencies:[x],encapsulation:2})};export{w as AuthCallbackComponent};
